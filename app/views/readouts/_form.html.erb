<%# TODO: add readout reordering by dragging %>
<%= tabular_fields_for 'readouts[]', readout do |form| %>
  <%- tag.tr id: dom_id(readout.quantity, :new, :readout) do %>
    <td class="actions">
      <%# TODO: change to _link_ after giving up displaying relative paths %>
      <%= image_button_tag '', 'delete-outline', class: 'dangerous', name: nil,
        formaction: discard_readouts_path(readout.quantity),
        formmethod: :get, formnovalidate: true, data: {turbo_stream: true} %>
    </td>
    <td>
      <%= readout.quantity.relative_pathname(@superquantity) %>
    </td>
    <td>
      <%= form.number_field :value, required: true,
        size: readout.type_for_attribute(:value).precision / 2,
        autofocus: readout_counter == 0 %>
    </td>
    <td>
      <%= form.hidden_field :quantity_id %>
      <%= form.collection_select :unit_id, @user_units, :id,
        ->(u){ sanitize('&emsp;' * (u.base_id ? 1 : 0) + u.symbol) },
        {prompt: t('.select_unit'), disabled: '', selected: ''}, required: true %>
    </td>
  <% end %>
<% end %>
